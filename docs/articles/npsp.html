<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nonparametric Spatial Data Analysis with the <em>npsp</em> Package • npsp</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">npsp</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/npsp.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/docs/aquifer.html">Análisis no paramétrico de datos espaciales (aquifer)</a>
    </li>
    <li>
      <a href="../articles/docs/Introduccion.html"> Introducción a la Geoestadística con R</a>
    </li>
    <li>
      <a href="../articles/krigstat.html">Kriging with gstat</a>
    </li>
    <li>
      <a href="../articles/precipitation.html">Total Monthly Precipitation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/rubenfcasal/npsp">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Nonparametric Spatial Data Analysis with the <em>npsp</em> Package</h1>
                        <h4 class="author">Ruben Fernandez-Casal (<a href="mailto:ruben.fcasal@udc.es">ruben.fcasal@udc.es</a>)</h4>
            
            <h4 class="date">npsp 0.6.2</h4>
          </div>

    
    
<div class="contents">
<div id="the-npsp-package" class="section level1">
<h1 class="hasAnchor">
<a href="#the-npsp-package" class="anchor"></a>The <code>npsp</code> package</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(npsp)</code></pre></div>
<pre><code>##  Package npsp: Nonparametric Spatial Statistics,
##  version 0.6-2 (built on 2017-10-02).
##  Copyright (C) R. Fernandez-Casal 2012-2017.
##  Type `help(npsp)` for an overview of the package and
##  `demo(package = "npsp")` for the list of available demos.</code></pre>
<div id="example-nonparametric-spatial-analyses-of-wolfcamp-aquifer-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-nonparametric-spatial-analyses-of-wolfcamp-aquifer-data" class="anchor"></a>Example: Nonparametric spatial analyses of Wolfcamp aquifer data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#   ?aquifer</span>
<span class="kw">str</span>(aquifer)</code></pre></div>
<pre><code>## 'data.frame':    85 obs. of  3 variables:
##  $ lon : num  42.78 -27.4 -1.16 -18.62 96.47 ...
##  $ lat : num  127.6 90.8 84.9 76.5 64.6 ...
##  $ head: num  1464 2553 2158 2455 1756 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#   Scatter plot with a color scale</span>
<span class="kw">with</span>(aquifer, <span class="kw"><a href="../reference/spoints.html">spoints</a></span>(lon, lat, head, <span class="dt">main =</span> <span class="st">"Wolfcamp aquifer data"</span>))</code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="model" class="section level2">
<h2 class="hasAnchor">
<a href="#model" class="anchor"></a>Model</h2>
<p>Model: <span class="math display">\[Y(\mathbf{x})=m(\mathbf{x})+\varepsilon(\mathbf{x})\]</span></p>
<ul>
<li><p><span class="math inline">\(m(\cdot)\)</span> tendencia (función de regresión).</p></li>
<li><p><span class="math inline">\(\varepsilon\)</span> proceso de error estacionario de 2<span class="math inline">\({{}^o}\)</span> orden, de media cero y covariograma <span class="math inline">\(C(\cdot)\)</span>.</p></li>
</ul>
<p>Modelo <strong>no paramétrico</strong>: no se supone ninguna forma concreta para <span class="math inline">\(m(\mathbf{\cdot})\)</span> y <span class="math inline">\(\gamma(\mathbf{\cdot})\)</span> (funciones suaves).</p>
<p>Ventajas:</p>
<ul>
<li><p>Evitan problemas debidos a una mala especificación del modelo.</p></li>
<li><p>Más fáciles de automatizar.</p></li>
<li><p>De utilidad en inferencia paramétrica.</p></li>
</ul>
</div>
<div id="example-wolfcamp-aquifer" class="section level2">
<h2 class="hasAnchor">
<a href="#example-wolfcamp-aquifer" class="anchor"></a>Example: Wolfcamp aquifer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(aquifer)</code></pre></div>
<pre><code>##       lon               lat               head     
##  Min.   :-145.24   Min.   :  9.414   Min.   :1024  
##  1st Qu.: -21.30   1st Qu.: 33.682   1st Qu.:1548  
##  Median :  11.66   Median : 59.158   Median :1797  
##  Mean   :  16.89   Mean   : 79.356   Mean   :2002  
##  3rd Qu.:  70.90   3rd Qu.:131.825   3rd Qu.:2540  
##  Max.   : 112.80   Max.   :184.766   Max.   :3571</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/scattersplot.html">scattersplot</a></span>(aquifer[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], aquifer<span class="op">$</span>head<span class="op">/</span><span class="dv">100</span>, 
             <span class="dt">main =</span> <span class="st">"Wolfcamp aquifer data"</span>, <span class="dt">xlab =</span> <span class="st">'lon'</span>, 
             <span class="dt">ylab=</span><span class="st">'lat'</span>, <span class="dt">zlab =</span> <span class="st">'piezometric-head  (hundreds)'</span>,
             <span class="dt">col =</span> <span class="kw"><a href="../reference/splot.html">jet.colors</a></span>(<span class="dv">128</span>))</code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="herramientas-disponibles-en-r" class="section level2">
<h2 class="hasAnchor">
<a href="#herramientas-disponibles-en-r" class="anchor"></a>Herramientas disponibles en R</h2>
<p>Geoestadística:</p>
<ul>
<li>
<code>geoR</code>, <code>fields</code>, <code>sm</code>, …</li>
</ul>
<p>Estadística no paramétrica:</p>
<ul>
<li><p><code>mgcv</code> (splines), <code>KernSmooth</code></p></li>
<li><p><code>modreg</code> (stats), <code>MASS</code>, <code>gam</code></p></li>
<li><p><code>sm</code>, <code>locfit</code>, <code>ks</code>, <code>fields</code>, <code>locpol</code>, <code>bigvis</code>, …</p></li>
</ul>
<p>Problemas:</p>
<ul>
<li><p>Funcionalidad muy limitada para estadística espacial no paramétrica .</p></li>
<li><p>Dificultad para implementar nuevos métodos.</p></li>
<li><p>Otras limitaciones: lentitud (e.g. no binning), n<span class="math inline">\({{}^o}\)</span> de dimensiones,…</p></li>
</ul>
<p>El paquete <code>npsp</code>: <a href="https://cran.r-project.org/package=npsp" class="uri">https://cran.r-project.org/package=npsp</a></p>
</div>
</div>
<div id="linear-binning" class="section level1">
<h1 class="hasAnchor">
<a href="#linear-binning" class="anchor"></a>Linear binning</h1>
<p>Para acelerar los cálculos se emplea binning (WARPing; e.g. Wand and Jones, 1995):</p>
<ul>
<li><p>datos <span class="math inline">\(\Longrightarrow\)</span> discretización <span class="math inline">\(\Longrightarrow\)</span> suavizado <span class="math inline">\(\Longrightarrow\)</span> interpolación</p></li>
<li><p>Discretización: binning lineal.</p></li>
</ul>
<p>Procedimiento análogo para interpolación lineal.</p>
<div id="npsp-functions-binning-s3-generic-and-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#npsp-functions-binning-s3-generic-and-methods" class="anchor"></a><code>npsp</code> functions: <code>binning</code> (S3 generic and methods), …</h3>
<p>Binning:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#   fig.height=5, fig.width=5}</span>
<span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">reset=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## CPU time has been initialized.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bin &lt;-<span class="st"> </span><span class="kw"><a href="../reference/binning.html">binning</a></span>(aquifer[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], aquifer<span class="op">$</span>head, <span class="dt">nbin =</span> <span class="kw">c</span>(<span class="dv">41</span>,<span class="dv">41</span>), <span class="dt">set.NA =</span> <span class="ot">TRUE</span>) 
<span class="kw"><a href="../reference/simage.html">simage</a></span>(bin, <span class="dt">main =</span> <span class="st">'Binning averages'</span>)
<span class="kw">points</span>(bin<span class="op">$</span>data<span class="op">$</span>x, <span class="dt">col =</span> <span class="st">'darkgray'</span>)</code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-4-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.02    0.00    0.01</code></pre>
</div>
<div id="npsp-functions-interp-s3-generic-and-methods-predict-methods-locpol-bin-y-np-den-" class="section level3">
<h3 class="hasAnchor">
<a href="#npsp-functions-interp-s3-generic-and-methods-predict-methods-locpol-bin-y-np-den-" class="anchor"></a><code>npsp</code> functions: <code>interp</code> (S3 generic and methods), <code>predict</code> (methods <code>locpol.bin</code> y <code>np.den</code>).</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nbin.hd &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">128</span>, <span class="dv">128</span>)
bin.nna &lt;-<span class="st"> </span><span class="kw"><a href="../reference/binning.html">binning</a></span>(aquifer[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], aquifer<span class="op">$</span>head, <span class="dt">nbin =</span> nbin.hd)
<span class="kw">with</span>(bin.nna<span class="op">$</span>data, <span class="kw">summary</span>((y <span class="op">-</span><span class="st"> </span><span class="kw"><a href="../reference/interp.html">interp</a></span>(bin.nna, <span class="dt">newx =</span> x)<span class="op">$</span>y)<span class="op">/</span>y ))</code></pre></div>
<pre><code>##       Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
## -0.0267747  0.0000000  0.0000000 -0.0001124  0.0000000  0.0249106</code></pre>
</div>
</div>
<div id="density-estimation" class="section level1">
<h1 class="hasAnchor">
<a href="#density-estimation" class="anchor"></a>Density estimation</h1>
<p>La estimación de la densidad está implementada como un caso particular de regresión (se suavizan los pesos binning reescalados).</p>
<div id="npsp-functions-np-den" class="section level3">
<h3 class="hasAnchor">
<a href="#npsp-functions-np-den" class="anchor"></a><code>npsp</code> functions: <code>np.den</code>, …</h3>
</div>
<div id="example-wolfcamp-aquifer-1" class="section level2">
<h2 class="hasAnchor">
<a href="#example-wolfcamp-aquifer-1" class="anchor"></a>Example: Wolfcamp aquifer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#   fig.height=7, fig.width=7}</span>
h.den &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">c</span>(<span class="dv">55</span>,<span class="dv">55</span>))<span class="co">#    alternatively: h.cv(as.bin.den(bin))$h</span>
den &lt;-<span class="st"> </span><span class="kw"><a href="../reference/np.den.html">np.den</a></span>(bin, <span class="dt">h =</span> h.den, <span class="dt">degree =</span> <span class="dv">0</span>)
<span class="kw">plot</span>(den, <span class="dt">main =</span> <span class="st">'Estimated log(density)'</span>)</code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#   Index with grid nodes far from data</span>
mask &lt;-<span class="st"> </span><span class="kw">log</span>(den<span class="op">$</span>est) <span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="dv">15</span>
bin &lt;-<span class="st"> </span><span class="kw"><a href="../reference/mask.html">mask</a></span>(bin, <span class="dt">mask =</span> mask)
<span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.17    0.04    0.22</code></pre>
</div>
</div>
<div id="trend-estimation" class="section level1">
<h1 class="hasAnchor">
<a href="#trend-estimation" class="anchor"></a>Trend estimation</h1>
<div id="regresion-polinomica-local" class="section level2">
<h2 class="hasAnchor">
<a href="#regresion-polinomica-local" class="anchor"></a>Regresión polinómica local</h2>
<div id="caso-univariante" class="section level3">
<h3 class="hasAnchor">
<a href="#caso-univariante" class="anchor"></a>Caso univariante</h3>
<p>Para cada <span class="math inline">\(x_{0}\)</span> se ajusta un polinomio: <span class="math display">\[\beta_{0}+\beta_{1}\left(x - x_{0}\right) + \cdots 
+ \beta_{p}\left( x-x_{0}\right)^{p}\]</span> por mínimos cuadrados ponderados con pesos <span class="math inline">\(w_{i} = \frac{1}{h}K\left(\frac{x-x_{0}}{h}\right)\)</span>.</p>
<ul>
<li><p><span class="math inline">\(\hat{m}_{h}(x_{0})=\hat{\beta}_{0}\)</span>.</p></li>
<li><p>Adicionalmente: <span class="math inline">\(\widehat{m_{h}^{r)}}(x_{0}) = r!\hat{\beta}_{r}\)</span>.</p></li>
</ul>
<p>Habitualmente:</p>
<ul>
<li><p><span class="math inline">\(p=0\)</span>: Estimador Nadaraya-Watson.</p></li>
<li><p><span class="math inline">\(p=1\)</span>: Estimador lineal local.</p></li>
</ul>
</div>
<div id="caso-multivariante" class="section level3">
<h3 class="hasAnchor">
<a href="#caso-multivariante" class="anchor"></a>Caso multivariante</h3>
<p>Análogo al caso univariante.</p>
<p>Estimador lineal local multivariante: <span class="math display">\[\min_{\beta_{0},\boldsymbol{\beta}_{1}}\sum_{i=1}^{n}
\left( Y(\mathbf{x}_{i})-\beta_{0}-{\boldsymbol{\beta}}_{1}^{t}
(\mathbf{x}_{i}-\mathbf{x})\right)^{2}
K_{\mathbf{H}}(\mathbf{x}_{i}-\mathbf{x}),\]</span> <span class="math inline">\(\hat{m}_{\mathbf{H}}(\mathbf{x})=\hat{\beta}_{0}\)</span>, donde:</p>
<ul>
<li><p><span class="math inline">\(\mathbf{H}\)</span> matriz definida positiva de orden <span class="math inline">\(d\)</span>.</p></li>
<li><p><span class="math inline">\(K_{\mathbf{H}}(\mathbf{u})=\left\vert \mathbf{H}\right\vert ^{-1}K(\mathbf{H}^{-1}\mathbf{u})\)</span>, <span class="math inline">\(K\)</span> núcleo multivariante.</p></li>
</ul>
<p>Explícitamente: <span class="math display">\[\hat{m}_{\mathbf{H}}(\mathbf{x}) = \mathbf{e}_{1}^{t} \left(
\mathbf{X}_{\mathbf{x}}^{t} {\mathbf{W}}_{\mathbf{x}} 
\mathbf{X}_{\mathbf{x}} \right)^{-1} \mathbf{X}_{\mathbf{x}}^{t} 
{\mathbf{W}}_{\mathbf{x}}\mathbf{Y} \equiv {s}_{\mathbf{x}}^{t}\mathbf{Y}\]</span></p>
<ul>
<li><p><span class="math inline">\(\mathbf{e}_{1} = \left( 1, \cdots, 0\right)^{t}\)</span>.</p></li>
<li><p><span class="math inline">\(\mathbf{X}_{\mathbf{x}}\)</span> matriz con <span class="math inline">\((1,(\mathbf{x}_{i}-\mathbf{x})^{t})\)</span> en fila <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(\mathbf{W}_{\mathbf{x}} = \mathtt{diag} \left( K_{\mathbf{H}}(\mathbf{x}_{1} - \mathbf{x}), ..., K_{\mathbf{H}}(\mathbf{x}_{n}-\mathbf{x}) \right)\)</span>.</p></li>
</ul>
<p>Matriz de suavizado o matriz hat <span class="math inline">\(\mathbf{S}\)</span>: matriz <span class="math inline">\(n\times n\)</span> con <span class="math inline">\(\mathbf{s}_{\mathbf{x}_{i}}^{t}\)</span> en la fila <span class="math inline">\(i\)</span>, tal que <span class="math inline">\(\mathbf{\hat{Y}}=\mathbf{SY}\)</span>.</p>
</div>
<div id="npsp-functions-locpol-s3-generic-and-methods-" class="section level3">
<h3 class="hasAnchor">
<a href="#npsp-functions-locpol-s3-generic-and-methods-" class="anchor"></a><code>npsp</code> functions: <code>locpol</code> (S3 generic and methods).</h3>
<ul>
<li><p>Permite cácular eficientemente la matriz de suavizado o matriz hat <span class="math inline">\(\mathbf{S}\)</span> (de utilidad p.e. para la estimación de la dependencia de los datos o la selección de la ventana).</p></li>
<li><p>Código <em>optimizado</em> para minimizar el tiempo de computación y los requerimientos de memoria. Especialmente en Validación cruzada, Estimación del variograma y Simulación.</p></li>
<li><p>Los cálculos se realizan en FORTRAN. Para resolver el problema de regresión lineal (local), el paquete <code>npsp</code> emplea una modificación de la rutina DGELSY de la librería LAPACK (admite matrices de rango deficiente).</p></li>
</ul>
</div>
</div>
<div id="example-wolfcamp-aquifer-2" class="section level2">
<h2 class="hasAnchor">
<a href="#example-wolfcamp-aquifer-2" class="anchor"></a>Example: Wolfcamp aquifer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/locpol.html">locpol</a></span>(bin, <span class="dt">h =</span> <span class="kw">diag</span>(<span class="dv">75</span>, <span class="dv">2</span>), <span class="dt">hat.bin =</span> <span class="ot">TRUE</span>)  
<span class="co">#                                  np.svariso.corr: 'lp' must have a '$locpol$hat' component</span>
<span class="co"># Perspective plot with a color scale</span>
<span class="kw"><a href="../reference/spersp.html">spersp</a></span>(lp, <span class="dt">main =</span> <span class="st">'Trend estimates'</span>, <span class="dt">zlab =</span> <span class="st">'piezometric-head levels'</span>, 
       <span class="dt">theta =</span> <span class="dv">120</span>)   </code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.31    0.03    0.34</code></pre>
</div>
</div>
<div id="variogram-estimation" class="section level1">
<h1 class="hasAnchor">
<a href="#variogram-estimation" class="anchor"></a>Variogram estimation</h1>
<div id="modelado-de-la-dependencia" class="section level2">
<h2 class="hasAnchor">
<a href="#modelado-de-la-dependencia" class="anchor"></a>Modelado de la dependencia</h2>
<p>También se realiza a partir de los residuos: <span class="math display">\[e(\mathbf{x}_{i})=Y(\mathbf{x}_{i})-\hat{m}(\mathbf{x}_{i})\]</span></p>
<p><em>Note</em>: To avoid the biases in variogram estimation, the use of (the fully nonparametric correction algorithm in) function <code><a href="../reference/np.svar.html">np.svariso.corr()</a></code> will be recomended (see e.g. Fernández-Casal and Francisco-Fernández, 2013, or the section about <a href="#bias-corrected-variogram-estimation">Bias-corrected variogram estimation</a>)</p>
<p>Si la media se supone cte.: <span class="math inline">\(e(\mathbf{x}_{i})\equiv Y(\mathbf{x}_{i})\)</span>.</p>
<p>Se puede ver como un caso particular de regresión: <span class="math display">\[\gamma\left(  \mathbf{x}_{i}-\mathbf{x}_{j}\right)  =\frac{1}{2}E\left(
\varepsilon(\mathbf{x}_{i})-\varepsilon(\mathbf{x}_{j})\right)^{2}\]</span></p>
<p>con <span class="math inline">\(N=\frac{n(n-1)}{2}\)</span> observaciones: <span class="math display">\[{\left(\mathbf{x}_{i}-\mathbf{x}_{j},
(e(\mathbf{x}_{i})-e(\mathbf{x}_{j}))^2 / 2 \right)}\]</span> (sesgadas si se estima la tendencia).</p>
</div>
<div id="estimacion-piloto-del-variograma" class="section level2">
<h2 class="hasAnchor">
<a href="#estimacion-piloto-del-variograma" class="anchor"></a>Estimación piloto del variograma</h2>
<p>Estimador polinómico local:</p>
<p><span class="math display">\[\begin{aligned}
\min_{\beta_{0}, \boldsymbol{\beta}_{1}, \cdots}
\sum_{i=1}^{n}\left( \frac{1}{2} \left( e(\mathbf{x}_{i})-e(\mathbf{x}_{j})
\right)^{2} - \beta_{0} - {\boldsymbol{\beta}}_{1}^{t} (\mathbf{x}_{i} - 
mathbf{x}_{j} - \mathbf{u}) - \cdots\right)  ^{2}\times &amp; \\
K_{\mathbf{G}}(\mathbf{x}_{i}-\mathbf{x}_{j}-\mathbf{u})  &amp;
\end{aligned}\]</span></p>
<p><span class="math inline">\(\hat{\gamma}_{\mathbf{G}}(\mathbf{u}) = \hat{\beta}_{0}\)</span>.</p>
<div id="npsp-functions-svar-bin-h-cv-y-np-svar" class="section level3">
<h3 class="hasAnchor">
<a href="#npsp-functions-svar-bin-h-cv-y-np-svar" class="anchor"></a><code>npsp</code> functions: <code>svar.bin</code>, <code>h.cv</code> y <code>np.svar</code>
</h3>
</div>
</div>
<div id="ajuste-de-un-modelo-no-parametrico" class="section level2">
<h2 class="hasAnchor">
<a href="#ajuste-de-un-modelo-no-parametrico" class="anchor"></a>Ajuste de un modelo no paramétrico</h2>
<p>Los estimadores anteriores no pueden ser usados en kriging.</p>
<p>Para resolver este problema se ajusta un modelo válido.</p>
<p>Modelos no paramétricos de Shapiro-Botha. Caso isotrópico: <span class="math display">\[\gamma(\left\Vert \mathbf{u} \right\Vert ) = \nu_{0} - 
    \sum\limits_{k=1}^{K}\kappa_{d}(x_{k}\left\Vert \mathbf{u}\right\Vert )z_{k},\]</span></p>
<ul>
<li><p><span class="math inline">\(x_{k}\)</span> nodos de discretización (fijos).</p></li>
<li><p><span class="math inline">\(\kappa_{d}(x) = \left( \tfrac{2}{x}\right)^{{\frac{d{-2}}{2}}} \Gamma\left( \tfrac{d}{2}\right) J_{{\frac{d{-2}}{2}}}(x),\ \ \  \kappa_{\infty}(x)\equiv e^{-x^{2}}\)</span>.</p></li>
<li><p><span class="math inline">\(\left( z_{1}, ..., z_{K}, \nu_{0} \right)^{t}\)</span> parámetros, verificando: <span class="math display">\[z_{k} \geq0 \text{ y } c_{0} = \nu_{0}-\sum\nolimits_{k=1}^{K}z_{k}\geq0.\]</span></p></li>
</ul>
<p>Extensibles al caso anisotrópico (Fernandez-Casal <em>et al</em>., 2003).</p>
<p>El ajuste por WLS a un conjunto de estimaciones piloto se puede realizar fácilmente mediante programación cuadrática (modificación de la función <code>solve.QP</code> del paquete <code>quadprog</code>).</p>
<div id="npsp-functions-fitsvar-sb-iso" class="section level3">
<h3 class="hasAnchor">
<a href="#npsp-functions-fitsvar-sb-iso" class="anchor"></a><code>npsp</code> functions: <code>fitsvar.sb.iso</code>
</h3>
</div>
</div>
<div id="example-wolfcamp-aquifer-3" class="section level2">
<h2 class="hasAnchor">
<a href="#example-wolfcamp-aquifer-3" class="anchor"></a>Example: Wolfcamp aquifer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lp.resid &lt;-<span class="st"> </span>lp<span class="op">$</span>data<span class="op">$</span>y <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(lp)
  maxlag &lt;-<span class="st"> </span><span class="fl">0.55</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="kw">diff</span>(<span class="kw">apply</span>(aquifer[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dv">2</span>, range))<span class="op">^</span><span class="dv">2</span>))
esvar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/np.svar.html">np.svariso</a></span>(aquifer[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], lp.resid, <span class="dt">maxlag =</span> <span class="dv">150</span>, <span class="dt">nlags =</span> <span class="dv">60</span>, <span class="dt">h =</span> <span class="dv">60</span>)
svm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitsvar.sb.iso.html">fitsvar.sb.iso</a></span>(esvar)  <span class="co">#   dk = 2</span>
<span class="kw">plot</span>(svm, <span class="dt">main =</span> <span class="st">"Nonparametric semivariogram and fitted model"</span>)</code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.13    0.03    0.16</code></pre>
</div>
<div id="bias-corrected-variogram-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#bias-corrected-variogram-estimation" class="anchor"></a>Bias-corrected variogram estimation</h2>
<p>The direct use of the residuals introduces a bias in the estimation of the variogram. This bias is usually negative and higher at large lags (e.g. Cressie, 1993, section 3.4.3). A correction for this bias is proposed in Fernandez-Casal and Francisco-Fernandez (2013). A similar algorithm (fully nonparametric) is implemented in <code>np.svariso.corr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">esvar2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/np.svar.html">np.svariso.corr</a></span>(lp, <span class="dt">maxlag =</span> <span class="dv">150</span>, <span class="dt">nlags =</span> <span class="dv">60</span>, <span class="dt">h =</span> <span class="dv">60</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code>## Iteration  2 :  1 
## Iteration  3 :  0.1021595 
## Iteration  4 :  0.07323588 
## Iteration  5 :  0.05777008 
## Iteration  6 :  0.04794432</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">svm2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitsvar.sb.iso.html">fitsvar.sb.iso</a></span>(esvar2)  <span class="co">#   dk = 2</span>
<span class="kw">plot</span>(svm2, <span class="dt">main =</span> <span class="st">"Nonparametric bias-corrected semivariogram and fitted models"</span>, 
     <span class="dt">lwd =</span> <span class="dv">2</span>) 
<span class="kw">with</span>(svm<span class="op">$</span>fit, <span class="kw">lines</span>(u, fitted.sv, <span class="dt">lty =</span> <span class="dv">2</span>))</code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-9-2.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.34    0.04    0.37</code></pre>
</div>
</div>
<div id="bandwidth-selection" class="section level1">
<h1 class="hasAnchor">
<a href="#bandwidth-selection" class="anchor"></a>Bandwidth selection</h1>
<ul>
<li><p>Validación cruzada tradicional:<span class="math display">\[CV(\mathbf{H})=\frac{1}{n}\sum_{i=1}^{n}
\left( Y(\mathbf{x}_{i}) - \hat{m}_{-i}(\mathbf{x}_{i}) \right)^{2},\]</span> siendo <span class="math inline">\(\hat{m}_{-i}(\mathbf{x}_{i})\)</span> la estimación obtenida eliminando el dato <span class="math inline">\(i\)</span>.</p></li>
<li><p>Validación cruzada modificada para dependencia (Chu and Marron, 1991): <span class="math display">\[CV_{m}(\mathbf{H})=\frac{1}{n}\sum_{i=1}^{n}\left(  Y(\mathbf{x}_{i})-\hat
{m}_{-N(i)}(\mathbf{x}_{i})\right)^{2},\]</span> siendo <span class="math inline">\(\hat{m}_{-i}(\mathbf{x}_{i})\)</span> la estimación obtenida eliminando los datos en un vecindario <span class="math inline">\(N(i)\)</span> de <span class="math inline">\(\mathbf{x}_{i}\)</span>.</p></li>
<li><p>Validación cruzada generalizada con corrección de sesgo para dependencia (Francisco-Fernandez and Opsomer, 2005): <span class="math display">\[GCV_{c}(\mathbf{H})=\frac{1}{n}\sum_{i=1}^{n}\left(  \frac{Y(\mathbf{x}_{i})-\hat{m}(\mathbf{x}_{i})}{1-\frac{1}{n}tr\left(  \mathbf{SR}\right)
}\right)  ^{2},\]</span> siendo <span class="math inline">\(\mathbf{R}\)</span> la matriz de correlaciones (estimada).</p></li>
</ul>
<div id="npsp-functions-h-cv-hcv-data-locpolhcv" class="section level3">
<h3 class="hasAnchor">
<a href="#npsp-functions-h-cv-hcv-data-locpolhcv" class="anchor"></a><code>npsp</code> functions: <code>h.cv</code>, <code>hcv.data</code>, <code>locpolhcv</code>, …</h3>
</div>
<div id="example-wolfcamp-aquifer-4" class="section level2">
<h2 class="hasAnchor">
<a href="#example-wolfcamp-aquifer-4" class="anchor"></a>Example: Wolfcamp aquifer</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#   Example (speeding computations...):</span>
bin2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/binning.html">binning</a></span>(aquifer[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], aquifer<span class="op">$</span>head, <span class="dt">nbin =</span> <span class="kw">c</span>(<span class="dv">21</span>,<span class="dv">21</span>))
<span class="co"># Warning: There is not enough data in some neighborhoods ('NRL &lt; NINDRL'):</span>
<span class="kw"><a href="../reference/h.cv.html">h.cv</a></span>(bin2, <span class="dt">h.start =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">25</span>), <span class="dt">objective =</span> <span class="st">"GCV"</span>, <span class="dt">ncv =</span> <span class="dv">0</span>)</code></pre></div>
<pre><code>## $h
##          [,1]     [,2]
## [1,] 70.49316  0.00000
## [2,]  0.00000 66.65354
## 
## $value
## [1] 30321.69
## 
## $objective
## [1] "GCV"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># cov.bin &lt;-  varcov(svm2, coords = coords(bin2))</span>
lp.h &lt;-<span class="st"> </span><span class="kw"><a href="../reference/h.cv.html">h.cv</a></span>(bin2, <span class="dt">h.start =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">25</span>), <span class="dt">objective =</span> <span class="st">"GCV"</span>, <span class="dt">ncv =</span> <span class="dv">0</span>, <span class="dt">cov.bin =</span> svm2)
lp.h</code></pre></div>
<pre><code>## $h
##          [,1]     [,2]
## [1,] 406.4146  0.00000
## [2,]   0.0000 65.67983
## 
## $value
## [1] 53359.01
## 
## $objective
## [1] "GCV"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.94    0.25    1.19</code></pre>
</div>
</div>
<div id="final-estimation" class="section level1">
<h1 class="hasAnchor">
<a href="#final-estimation" class="anchor"></a>Final estimation</h1>
<div id="trend-re-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#trend-re-estimation" class="anchor"></a>trend re-estimation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/locpol.html">locpol</a></span>(lp, <span class="dt">h =</span> lp.h<span class="op">$</span>h, <span class="dt">hat.bin =</span> <span class="ot">TRUE</span>)   <span class="co"># np.svariso.corr</span>
<span class="co"># Perspective plot with a color scale</span>
<span class="kw"><a href="../reference/spersp.html">spersp</a></span>(lp, <span class="dt">main =</span> <span class="st">'Trend estimates'</span>, <span class="dt">zlab =</span> <span class="st">'piezometric-head levels'</span>, <span class="dt">theta =</span> <span class="dv">120</span>)   </code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.12    0.06    0.19</code></pre>
</div>
<div id="variogram-re-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#variogram-re-estimation" class="anchor"></a>Variogram re-estimation</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lp.resid &lt;-<span class="st"> </span><span class="kw">residuals</span>(lp)
esvar &lt;-<span class="st"> </span><span class="kw"><a href="../reference/np.svar.html">np.svariso</a></span>(aquifer[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], lp.resid, <span class="dt">maxlag =</span> <span class="dv">150</span>, <span class="dt">nlags =</span> <span class="dv">60</span>, <span class="dt">h =</span> <span class="dv">60</span>)
svm &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitsvar.sb.iso.html">fitsvar.sb.iso</a></span>(esvar)  <span class="co"># dk = 2</span>
esvar3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/np.svar.html">np.svariso.corr</a></span>(lp, <span class="dt">maxlag =</span> <span class="dv">150</span>, <span class="dt">nlags =</span> <span class="dv">60</span>, <span class="dt">h =</span> <span class="dv">60</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
svm3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fitsvar.sb.iso.html">fitsvar.sb.iso</a></span>(esvar3, <span class="dt">dk =</span> <span class="dv">0</span>)

<span class="kw">plot</span>(svm3, <span class="dt">main =</span> <span class="st">"Nonparametric bias-corrected semivariogram and fitted models"</span>, 
     <span class="dt">lwd =</span> <span class="dv">2</span>) 
<span class="co"># with(svm$fit, lines(u, fitted.sv, lty = 2))</span>
<span class="kw">with</span>(svm2<span class="op">$</span>fit, <span class="kw">lines</span>(u, fitted.sv, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>))</code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.21    0.04    0.25</code></pre>
</div>
<div id="trend-and-variogram-re-re-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#trend-and-variogram-re-re-estimation" class="anchor"></a>trend and variogram re-re-estimation?</h2>
<p>Do you think it is necessary?…</p>
<p>Compute the final trend estimates:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/locpol.html">locpol</a></span>(aquifer[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], aquifer<span class="op">$</span>head, <span class="dt">nbin =</span> nbin.hd, 
             <span class="dt">h =</span> lp<span class="op">$</span>locpol<span class="op">$</span>h, <span class="dt">hat.bin =</span> <span class="ot">FALSE</span>)
<span class="co"># Perspective plot with a color scale</span>
<span class="kw"><a href="../reference/simage.html">simage</a></span>(lp, <span class="dt">main =</span> <span class="st">'Final trend estimates</span><span class="ch">\n</span><span class="st">(piezometric-head levels)'</span>)   </code></pre></div>
<p><img src="npsp_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    1.98    0.02    1.99</code></pre>
</div>
</div>
<div id="kriging-predictions" class="section level1">
<h1 class="hasAnchor">
<a href="#kriging-predictions" class="anchor"></a>Kriging predictions</h1>
<p>Cressie, 1993 Chilés y Delfiner,</p>
<div id="npsp-functions-kriging-np" class="section level3">
<h3 class="hasAnchor">
<a href="#npsp-functions-kriging-np" class="anchor"></a><code>npsp</code> functions: <code>kriging.np</code>
</h3>
</div>
<div id="example-wolfcamp-aquifer-5" class="section level2">
<h2 class="hasAnchor">
<a href="#example-wolfcamp-aquifer-5" class="anchor"></a>Example: Wolfcamp aquifer</h2>
<div id="kriging-system" class="section level3">
<h3 class="hasAnchor">
<a href="#kriging-system" class="anchor"></a>Kriging system</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">krig.grid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/kriging.np.html">kriging.np</a></span>(lp, svm3)
<span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>(<span class="dt">total =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.39    0.06    0.46</code></pre>
</div>
<div id="kriging-maps" class="section level3">
<h3 class="hasAnchor">
<a href="#kriging-maps" class="anchor"></a>Kriging maps</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/simage.html">simage</a></span>(krig.grid, <span class="st">'kpred'</span>, <span class="dt">main =</span> <span class="st">'Kriging predictions'</span>, 
       <span class="dt">col =</span>  <span class="kw"><a href="../reference/splot.html">jet.colors</a></span>(<span class="dv">256</span>))</code></pre></div>
<p><img src="npsp_files/figure-html/kriging.maps-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/simage.html">simage</a></span>(krig.grid, <span class="st">'ksd'</span>, <span class="dt">main =</span> <span class="st">'Kriging sd'</span>, <span class="dt">col =</span>  <span class="kw"><a href="../reference/splot.html">hot.colors</a></span>(<span class="dv">256</span>))
<span class="kw">with</span>(aquifer, <span class="kw">points</span>(lon, lat, <span class="dt">cex =</span> <span class="fl">0.75</span>))</code></pre></div>
<p><img src="npsp_files/figure-html/kriging.maps-2.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/cpu.time.html">cpu.time</a></span>()</code></pre></div>
<pre><code>## Time of last operation: 
##    user  system elapsed 
##    0.09    0.05    0.14 
## Total time:
##    user  system elapsed 
##    4.70    0.62    5.32</code></pre>
</div>
</div>
</div>
<div id="resumen-y-futuras-implementaciones" class="section level1">
<h1 class="hasAnchor">
<a href="#resumen-y-futuras-implementaciones" class="anchor"></a>Resumen y futuras implementaciones</h1>
<div id="resumen" class="section level2">
<h2 class="hasAnchor">
<a href="#resumen" class="anchor"></a>Resumen</h2>
<p>Entorno homogéneo para la estimación polinómica lócal multidimensional: densidad, tendencia, variograma,…</p>
<ul>
<li><p>Binning, matriz de suavizado, derivadas, …</p></li>
<li><p>Mínima dependencia de otros paquetes.</p></li>
</ul>
<p>Trata de minimizar el tiempo de computación y los requerimientos de memoria.</p>
<p>Clases y métodos S3 sencillos.</p>
<ul>
<li><p>Pensado para interactuar con las clases S4 del paquete <code>sp</code>.</p></li>
<li><p>Del mismo tipo que las del paquete alternativo <code>sf</code>.</p></li>
</ul>
<p>Fácil implementación de nuevos métodos.</p>
</div>
<div id="futuras-implementaciones" class="section level2">
<h2 class="hasAnchor">
<a href="#futuras-implementaciones" class="anchor"></a>Futuras implementaciones</h2>
<ul>
<li><p>Modelos anisotrópicos de semivariograma (caso espacio-temporal).</p></li>
<li><p>Modelos aditivos y parcialmente lineales.</p></li>
<li><p>Kriging local.</p></li>
<li><p>…</p></li>
</ul>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<ul>
<li><p>Chu, C.K. and Marron, J.S. (1991) Comparison of Two Bandwidth Selectors with Dependent Errors. <em>The Annals of Statistics</em>, 19, 1906-1918.</p></li>
<li><p>Fernandez-Casal R. and Francisco-Fernandez M. (2013) Nonparametric bias-corrected variogram estimation under non-constant trend. <em>Stoch. Environ. Res. Ris. Assess. (SERRA)</em>, 1-14, <a href="doi:10.1007/s00477-013-0817-8" class="uri">doi:10.1007/s00477-013-0817-8</a>.</p></li>
<li><p>Fernandez-Casal R., Gonzalez-Manteiga W. and Febrero-Bande M. (2003) Flexible Spatio-Temporal Stationary Variogram Models. <em>Statistics and Computing</em>, 13, 127-136.</p></li>
<li><p>Francisco-Fernandez M. and Opsomer J.D. (2005) Smoothing parameter selection methods for nonparametric regression with spatially correlated errors. <em>Canadian Journal of Statistics</em>, 33, 539-558.</p></li>
<li><p>Wand M.P. and Jones M.C. (1995) <em>Kernel Smoothing</em>. Chapman and Hall.</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#the-npsp-package">The <code>npsp</code> package</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-nonparametric-spatial-analyses-of-wolfcamp-aquifer-data">Example: Nonparametric spatial analyses of Wolfcamp aquifer data</a></li>
      <li><a href="#model">Model</a></li>
      <li><a href="#example-wolfcamp-aquifer">Example: Wolfcamp aquifer</a></li>
      <li><a href="#herramientas-disponibles-en-r">Herramientas disponibles en R</a></li>
      </ul>
</li>
      <li><a href="#linear-binning">Linear binning</a></li>
      <li>
<a href="#density-estimation">Density estimation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-wolfcamp-aquifer-1">Example: Wolfcamp aquifer</a></li>
      </ul>
</li>
      <li>
<a href="#trend-estimation">Trend estimation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#regresion-polinomica-local">Regresión polinómica local</a></li>
      <li><a href="#example-wolfcamp-aquifer-2">Example: Wolfcamp aquifer</a></li>
      </ul>
</li>
      <li>
<a href="#variogram-estimation">Variogram estimation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#modelado-de-la-dependencia">Modelado de la dependencia</a></li>
      <li><a href="#estimacion-piloto-del-variograma">Estimación piloto del variograma</a></li>
      <li><a href="#ajuste-de-un-modelo-no-parametrico">Ajuste de un modelo no paramétrico</a></li>
      <li><a href="#example-wolfcamp-aquifer-3">Example: Wolfcamp aquifer</a></li>
      <li><a href="#bias-corrected-variogram-estimation">Bias-corrected variogram estimation</a></li>
      </ul>
</li>
      <li>
<a href="#bandwidth-selection">Bandwidth selection</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-wolfcamp-aquifer-4">Example: Wolfcamp aquifer</a></li>
      </ul>
</li>
      <li>
<a href="#final-estimation">Final estimation</a><ul class="nav nav-pills nav-stacked">
<li><a href="#trend-re-estimation">trend re-estimation</a></li>
      <li><a href="#variogram-re-estimation">Variogram re-estimation</a></li>
      <li><a href="#trend-and-variogram-re-re-estimation">trend and variogram re-re-estimation?</a></li>
      </ul>
</li>
      <li>
<a href="#kriging-predictions">Kriging predictions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-wolfcamp-aquifer-5">Example: Wolfcamp aquifer</a></li>
      </ul>
</li>
      <li>
<a href="#resumen-y-futuras-implementaciones">Resumen y futuras implementaciones</a><ul class="nav nav-pills nav-stacked">
<li><a href="#resumen">Resumen</a></li>
      <li><a href="#futuras-implementaciones">Futuras implementaciones</a></li>
      </ul>
</li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ruben Fernandez-Casal.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
